<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Purchase Ticket</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="br.png" type="image/png">
</head>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const dateInput = document.getElementById('journeyDate');

    function formatDate(date) {
      const yyyy = date.getFullYear();
      const mm = String(date.getMonth() + 1).padStart(2, '0');
      const dd = String(date.getDate()).padStart(2, '0');
      return `${yyyy}-${mm}-${dd}`;
    }

    const today = new Date();
    const maxDate = new Date();
    maxDate.setDate(today.getDate() + 10);

    dateInput.min = formatDate(today);
    dateInput.max = formatDate(maxDate);
  });

document.addEventListener('DOMContentLoaded', () => {
  const fromInput = document.getElementById('fromStation');
  const toInput   = document.getElementById('toStation');
  const dateInput = document.getElementById('journeyDate');
  const statusEl  = document.getElementById('status');

  const today  = new Date();
  const maxDay = new Date();
  maxDay.setDate(today.getDate() + 10);
  dateInput.min = formatDate(today);
  dateInput.max = formatDate(maxDay);

  [fromInput, toInput, dateInput].forEach(el =>
    el.addEventListener('input', updateStatus)
  );
  updateStatus();

  function formatDate(d) {
    const yyyy = d.getFullYear();
    const mm   = String(d.getMonth() + 1).padStart(2, '0');
    const dd   = String(d.getDate()).padStart(2, '0');
    return `${yyyy}-${mm}-${dd}`;
  }

  function updateStatus() {
    const fs = fromInput.value.trim().toLowerCase();
    const ts = toInput.value.trim().toLowerCase();
    const dv = dateInput.value;
    if (!fs || !ts || !dv) {
      statusEl.textContent = '';
      statusEl.className = '';
      return;
    }

    const selDate = new Date(dv);
    const zeroNow = new Date();
    zeroNow.setHours(0,0,0,0);

    // Dayâ€‘ofâ€‘week
    const dow = selDate.getDay();
    let statusDay;
    if ([4,5,6].includes(dow))      statusDay = 'Low';
    else if (dow === 0)             statusDay = 'Medium';
    else                            statusDay = 'High';

    //Date offset only today 
    const diff = Math.floor((selDate - zeroNow) / (1000*60*60*24));
    let statusDate = null;
    if (diff === 0) statusDate = 'Low';

    //Station rules
    const lowFrom = [
      "cox's bazar","narsingdi","azampur",
      "brahmanbaria","ashuganj","bhairab_bazar",
      "mymensingh","jamalpur_town"
    ];
    const lowDest = [
      "cox's bazar","narsingdi","brahmanbaria",
      "ashuganj","bhairab_bazar","mymensingh",
      "akhaura","azampur"
    ];
    let statusLoc = null;
    if (lowFrom.includes(fs)) {
      statusLoc = 'Low';
    } else if (fs === 'dhaka' && lowDest.includes(ts)) {
      statusLoc = 'Low';
    }

    // Merge (Low > Medium > High)
    const parts = [statusDay, statusDate, statusLoc].filter(Boolean);
    let finalStatus;
    if (parts.includes('Low'))        finalStatus = 'Low';
    else if (parts.includes('Medium')) finalStatus = 'Medium';
    else                               finalStatus = 'High';

    // Render text
    statusEl.textContent = `${finalStatus} Probability to get Ticket.
`;

    //Toggle CSS classes based on status
    statusEl.className = '';
    statusEl.classList.add(
      finalStatus.toLowerCase() === 'low'    ? 'status-low' :
      finalStatus.toLowerCase() === 'medium' ? 'status-medium' :
                                              'status-high'
    );
  }
});

</script>
<body>
  <header>
    <div class="container">
      <h1>ðŸš† Train Time Tracker</h1>
      <p id="datetime"></p>
    </div>
  </header>

  <div class="hamburger" onclick="toggleSidebar()">â˜°</div>

  <div id="sidebar" class="sidebar">
    <ul class="sidebar-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="roster.html">Roster</a></li>
      <li><a href="train.html">Train Information</a></li>
      <li><a href="ticket.html">Purchase Ticket</a></li>
      <li><a href="contact.html">Contact Us</a></li>
    </ul>
  </div>
  <div id="purchase">
    <img src="purchase.png" alt="Puchase">
  </div>
  <div>
    <h4 id="status"></h4>
  </div>

  <div class="ticket">
    <label for="fromStation">From Station</label>
    <input type="text" id="fromStation" name="fromStation" placeholder="Enter departure station" required />

    <label for="toStation">To Station</label>
    <input type="text" id="toStation" name="toStation" placeholder="Enter destination station" required />

    <label for="journeyDate">Enter Date</label>
    <input type="date" id="journeyDate" name="journeyDate" required />

    <button id="searchTrainBtn" onclick="searchTrain()">Search Train</button>
  </div>

  <footer>
    <div class="container">
      <p>&copy; 2025 Train Time Tracker. All rights reserved.</p>
    </div>
  </footer>

  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>
